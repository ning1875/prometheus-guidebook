

# 购买课程后 推荐的最佳学习模式
- 多思考，多质疑，多提问
- 跟着敲代码：不要只看视频
- 举一反三

# 决心 坚持下去




#  <font color=blue> 大运维平台7大模块</font>
- 01 资产管理 & cmdb & 服务树
- 02 工单 & 工作流 & 审批
- 03 cicd 全流程配置
- 04 Prometheus管理配置
- 05 k8s多集群管理

##  <font color=red>00 为什么是这7个模块</font>
- k8s/prometheus/cicd作为当下3大运维开发主流方向，这点大家都知道
- 但是如果只做上面3个模块还少了些基础的模块
- 这里的基础模块说的就是 cmdb和工单
- cmdb很好理解：
    - 监控/cicd/k8s等内部很多资源都属于资源
    - 资源就需要有管理的地方
    - 同时资产和服务的绑定形式应该是一颗服务树
    - 在服务树的节点上可以配置权限和绑定其他模块资源
        - 比如给 data.system.dns 绑定cicd发布模板可以发布dns配置
        - 比如给 infra.sre.apolloy绑定监控告警配置项
- 那么为什么还需要工单呢，主要原因有下面2点
    - 01 因为我们很多的操作需要工单审批之后才做
        - 比如 在页面上通过yaml编辑器编辑 k8s的deployment 会触发变更
        - 此时应该触发生成一张工单：经过预设的审批人审批后 再执行
    - 02 还有一些我们通用的运维工作需要工单支持
        - 比如调整安全组
        - 比如申请consul 服务发现token

# 各个实现细节上面：
- 一定程度的追新：


# 调研目的
- 热门模块有哪些：
    - 9个 都实现了 k8s
- 每个模块的核心功能
- 对于权限 、人员的管理
    - 角色，用户，菜单权限
        - 你可以控制哪些人能看到那些菜单  http://119.91.78.168:8090/wecmdb/#/wecmdb/admin/permission-management
        -
- 前后端的技术选型：
    - 用go的多不多
    - vue 还是react
- 页面布局之类


# 调研结果
- 用户权限：
  - 前端菜单权限
    - 也可以由后端提供接口 getMenu 这个人可以看到哪些菜单
    - 
  - 后端接口权限
- 登陆
  - logout http://localhost:3100/basic-api/logout?_t=1690080936282
  - login http://localhost:3100/basic-api/login
  - getUserInfo http://localhost:3100/basic-api/getUserInfo?_t=1690080986576
- 数据权限：对于数据端点 增删改查 执行的权限
- cicd  https://walle-web.io/docs
  - 可以配置流水线 发布项：都有哪些步骤，哪些主机
  - 调研_cicd发布项配置-复杂表单.png ![image](pic研_cicd发布项配置-复杂表单.png)
  - 执行过程，可视化输出--> 流程图
    - 执行到哪一步了，每一步的执行结果
  - 上线 cd 是需要工单的
- 资产管理
- 堡垒机
  - webssh操作记录回放
- 工单系统
  - 工单进度 ![image](pic研_工单进度.png)


【1】底座基础 第1章 第1章 课程形式和注意事项
【1】底座基础 第2章 开盲盒调研成品级别运维平台
【1】底座基础 第3章 从后台管理模板来调研运维平台
【1】底座基础 第4章 设计用户权限模块并熟悉体验vben
【1】底座基础 第5章 开发用户权限模块
【1】底座基础 第6章 菜单管理打通
【1】底座基础 第7章 用户和角色管理

【1】底座基础 第8章 用户管理剩余的逻辑
【1】底座基础 第9章 新增用户 分配角色 菜单管理串起来
【1】底座基础 第10章 golang后端软件准备工作
【1】底座基础 第11章 go准备之gin和日志
【1】底座基础 第12章 gin的中间件
【1】底座基础 第13章 gorm和登陆接口联调
【1】底座基础 第14章 gorm和菜单接口联调
【1】底座基础 第15章 gorm和用户角色接口联调01
【1】底座基础 第16章 gorm和用户角色接口联调02
【1】底座基础 第17章 rbac权限模型casbin和gorm
【1】底座基础 第18章 前端给角色绑定api接口树形结构


# 第一部分底座 课程大纲
- 第1章 课程形式和注意事项
  - 1.1 课程定位和注意事项
  - 1.2 学习所需要的软件


- 第2章 开盲盒调研成品级别运维平台
  - 2.1 调研用户角色多对多模型
  - 2.2 调研数据权限
  - 2.3 开盲盒 调研cicd部署过程
  - 2.4 开盲盒 用户权限前后端
  - 2.5 开盲盒 cicd可视化


- 第3章 从后台管理模板来调研运维平台
  - 3.1 搜索关键字 vue 后台管理系统
  - 3.2 vue3的后台管理系统
  - 3.3 全面的了解一下vben


- 第4章 设计用户权限模块并熟悉体验vben
  - 4.1 用户权限我们都需要什么
  - 4.2 安装vben
  - 4.3 熟悉一下vben目录
  - 4.4 熟悉一下vben基础配置
  - 4.5 熟悉一下vben路由
  - 4.6 熟悉一下vben菜单
  - 4.7 熟悉一下vben权限
  - 4.8 熟悉一下vben的mock
  - 4.9 熟悉一下vben的组件
  - 4.10 vben用户权限代码查看


- 第5章 开发用户权限模块
  - 5.1 查看角色路由权限代码
  - 5.2 角色切换和权限
  - 5.3 规划一下用户角色
  - 5.4 角色管理页面只有super可见
  - 5.5 设置角色状态和mock
  - 5.6 删除角色
  - 5.7 分析一下后端权限模式的代码
  - 5.8 getPermCode逻辑
  - 5.9 菜单编辑所有的字段含义1
  - 5.10 菜单编辑所有的字段含义2

第6章 go大运维平台开发之菜单管理打通6.5 补全新增菜单的逻辑
第6章 go大运维平台开发之菜单管理打通 父子关系菜单

- 第6章 菜单管理打通
  - 6.1 新增和编辑共用drawer
  - 6.2 表单字段定义和validate校验
  - 6.3 新增菜单的请求
  - 6.4 树形父子关系菜单最终效果
  - 6.5 补全新增菜单的逻辑
  - 6.6 菜单渲染和菜单数据一致
  - 6.7 解决菜单不断叠加的问题
  - 6.8 是否显示和菜单排序
  - 6.9 初始化的管理菜单和缺乏编辑-新增如何共享逻辑
  - 6.9 初始化的管理菜单
  - 6.10 菜单更新和删除

- 第7章 用户和角色管理
  - 7.1 角色管理菜单分配树形选中
  - 7.2 角色修改
  - 7.3 角色查询
  - 7.4 用户管理列表字段对齐
  - 7.5 根据条件设置样式
  - 7.6 用户信息表单防抖尝试
  - 7.7 使用登陆用到的用户信息数据
  - 7.8 用户角色列表ApiSelect
  - 7.9 角色列表前后端格式转化
  - 7.10 用户密码和用户信息编辑

- 第8章 用户管理剩余的逻辑
  - 8.1 新增和修改共用模态框的问题
  - 8.2 删除用户和收尾工作
  - 8.3 修改当前用户密码
  - 8.4 退出登录和token重复问题
  - 8.5 跳转登出和默认首页



- 第9章 新增用户 分配角色 菜单管理串起来
  - 9.1 划分菜单角色权限
  - 9.2 根据用户信息获取菜单列表
  - 9.3 给角色分配菜单的时候获取全量菜单列表
  - 9.4 新增角色登陆dbAcc列表不全的问题
  - 9.5 在mock中使用persistent存储失败
  - 9.6 验证低权限的用户登陆菜单并由admin修改
  - 9.7 发现部分子菜单显示不正常问题
  - 9.8 解决子菜单重复和父级不显示问题
  - 9.9 解决用户多角色菜单继承问题
  - 9.10 最后的验证和代码提交

- 第10章 golang后端软件准备工作
  - 10.1 后端技术选型和gin各个中间件
  - 10.2 必备软件的列表
  - 10.3 搭建ubuntu22.04模板机
  - 10.4 搭建k8s1.27最新版本集群
  - 10.5 部署mysql到k8s中
  - 10.6 部署redis到k8s中并做重启数据消失验证
  - 10.7 安装golang

- 第11章 go准备之gin和日志 
  - 11.1 规划目录结构
  - 11.2 开始gin的准备工作
  - 11.3 命令行传参和配置文件解析
  - 11.4 把gin单独启动
  - 11.5 json日志格式和控制台输出
  - 11.6 日志输出到文件和rotate

- 第12章 gin的中间件
  - 12.1 传递变量和打印耗时的gin中间件
  - 12.2 request-id日志和zap整合
  - 12.3 Prometheus记录qps
  - 12.4 认识jwt中间件
  - 12.5 定义通用响应结构体
  - 12.6 validator校验字段
  - 12.7 中文字典错误翻译器
  - 12.8 用户登陆生成jwt逻辑
  - 12.9 验证用户登陆生成jwt
  - 12.10 jwt临期刷新问题

- 第13章 gorm和登陆接口联调
  - 13.1 熟悉gorm
  - 13.2 schema和automigrate
  - 13.3 user和role多对多关系
  - 13.4 加盐hash生成密码
  - 13.5 登陆接口和关联preload
  - 13.6 getUserInfo接口
  - 13.7 菜单数据结构尝试联调
  - 13.8 前后端接口联调问题 
  - 13.9 login和getUserInfo 
  - 13.10 实现getMenulist接口 

- 第14章 gorm和菜单接口联调
  - 14.1 menus多对多创建问题
  - 14.2 gorm预加载a引用b引用c
  - 14.3 根据用户获取菜单getMenulist接口
  - 14.4 菜单编辑接口对接
  - 14.5 新增菜单接口对接
  - 14.6 获取全量菜单接口

【1】底座基础 第15章 gorm和用户角色接口联调01
【1】底座基础 第16章 gorm和用户角色接口联调02
【1】底座基础 第17章 rbac权限模型casbin和gorm
【1】底座基础 第18章 前端给角色绑定api接口树形结构

- 第15章 gorm和用户角色接口联调01
  - 15.1 用户操作时的获取全量角色接口对接
  - 15.2 log中间件不打印body问题
  - 15.3 新增用户接口对接
  - 15.4 获取用户列表
  - 15.5 编辑用户资料
  - 15.6 用户角色ApiSelect问题
  - 15.7 删除用户和更新用户
  - 15.8 获取角色列表
  - 15.9 树形结构treeDataSimpleMode
  - 15.10 使用原生的TreeSelect

- 第16章 gorm和用户角色接口联调02
  - 16.1 更新角色
  - 16.2 新增角色
  - 16.3 删除角色
  - 16.4 菜单管理的上级菜单问题
  - 16.5 菜单管理的上级菜单问题
  - 16.6 setRoleStatus接口-局部更新
  - 16.7 角色状态和菜单 新增用户密码
  - 16.8 修改密码
  - 16.9 在角色table中展示关联的用户

- 第17章 rbac权限模型casbin和gorm
  - 17.1 casbin基础知识
  - 17.2 casbin和gorm
  - 17.3 KeyMatch自定义模糊匹配
  - 17.4 casbin和gin整合梳理准备工作
  - 17.5 后端代码定义表结构mock数据
  - 17.6 gin和casbin整合
  - 17.7 进行测试
  - 17.8 前端api管理列表
  - 17.9 前端api新增编辑删除

- 第18章 前端给角色绑定api接口树形结构
  - 18.1 尝试用原生的drawer
  - 18.2 复用编辑角色drawer增加apis的树